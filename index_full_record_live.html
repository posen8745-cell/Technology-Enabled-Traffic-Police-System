<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tå­—è·¯å£ï½œä¸€éµåˆ‡æ›ã€ŒéŒ„å½± / çœŸå¯¦æ¨¡æ“¬ã€æœ€çµ‚å®Œæ•´ç‰ˆ</title>
<style>
/* ===== åŸç‰ˆæ¨£å¼ï¼ˆä¿ç•™ï¼‰ ===== */
:root{
  --bg:#0b1220; --panel:#121a2b; --text:#e8eefc; --muted:#a9b6d6;
  --good:#3cff7a; --bad:#ff3b3b; --warn:#ffd43b;
}
*{box-sizing:border-box}
body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI","Noto Sans TC",Arial;
background:radial-gradient(1200px 800px at 30% 20%, #18234a 0%, var(--bg) 55%, #060a14 100%);
color:var(--text);min-height:100vh;display:flex}
.wrap{width:min(1320px,100%);margin:0 auto;padding:18px;display:grid;grid-template-columns:1fr 460px;gap:16px}
.card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));
border:1px solid rgba(255,255,255,.08);border-radius:16px;box-shadow:0 18px 60px rgba(0,0,0,.35)}
.canvasWrap{padding:12px}
canvas{width:100%;height:680px;display:block;background:rgba(0,0,0,.18);border-radius:12px;border:1px solid rgba(255,255,255,.08)}
.panel{padding:14px;background:rgba(0,0,0,.12)}
h1{font-size:15px;margin:0 0 10px}
.pill{display:inline-flex;gap:8px;align-items:center;padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.18);font-size:12px;color:var(--muted)}
.dot{width:10px;height:10px;border-radius:50%}
.dot.green{background:var(--good)} .dot.red{background:var(--bad)} .dot.yellow{background:var(--warn)}
.divider{height:1px;background:rgba(255,255,255,.10);margin:12px 0}
.row{display:flex;gap:10px;align-items:center;justify-content:space-between;margin:10px 0}
label{font-size:13px;color:var(--muted)}
input[type=number],select{width:190px;padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.22);color:var(--text)}
button{padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.14);
background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.03));color:var(--text);font-weight:800;cursor:pointer}
.modeBtns{display:flex;gap:10px}
.modeBtn.active{border-color:rgba(60,255,140,.65);box-shadow:0 0 0 2px rgba(60,255,140,.2) inset}
.kv{display:grid;grid-template-columns:1fr auto;gap:10px;font-size:13px}
.mono{font-family:ui-monospace,Menlo,Consolas,monospace}

/* ===== æ–°å¢ï¼šä¸€éµåˆ‡æ› ===== */
.switch{display:flex;gap:10px;margin:8px 0}
.switch .rec{background:#7f1d1d}
.switch .live{background:#065f46}
.switch button.active{outline:3px solid rgba(60,255,140,.35)}
</style>
</head>

<body>
<div class="wrap">
  <div class="card canvasWrap"><canvas id="c"></canvas></div>

  <div class="card panel">
    <h1>ğŸ¬ ä¸€éµåˆ‡æ›ã€ŒéŒ„å½± / çœŸå¯¦æ¨¡æ“¬ã€æœ€çµ‚ç‰ˆ</h1>

    <div class="switch">
      <button id="btnRecord" class="rec active">ğŸ¥ éŒ„å½±æ¨¡å¼</button>
      <button id="btnLive" class="live">ğŸ§  çœŸå¯¦æ¨¡æ“¬</button>
    </div>

    <div class="pill"><span id="phaseDot" class="dot green"></span><span id="phaseText">Phaseï¼š--</span></div>
    <div class="divider"></div>

    <div class="row"><label>ä¸»ç·š1 ç›´è¡Œç¶ </label><input id="tM1SG" type="number" value="25"></div>
    <div class="row"><label>ä¸»ç·š1 é»ƒ</label><input id="tM1Y" type="number" value="3"></div>
    <div class="row"><label>ä¸»ç·š2 ç¶ </label><input id="tM2G" type="number" value="35"></div>
    <div class="row"><label>ä¸»ç·š2 é»ƒ</label><input id="tM2Y" type="number" value="3"></div>
    <div class="row"><label>å…¨ç´…</label><input id="tAR" type="number" value="1"></div>

    <div class="divider"></div>
    <div class="kv"><div>æœ¬ç›¸ä½å‰©é¤˜ç§’</div><div class="mono" id="count">--</div></div>
    <div class="kv"><div>ç›®å‰æ¨¡å¼</div><div class="mono" id="modeText">RECORD</div></div>
  </div>
</div>

<script>
/* ========= Canvas ========= */
const cv=document.getElementById('c'), ctx=cv.getContext('2d');
function resize(){cv.width=cv.clientWidth;cv.height=cv.clientHeight}
window.addEventListener('resize',resize);resize();

/* ========= ç‹€æ…‹ ========= */
const UI={
  phaseDot:phaseDot, phaseText:phaseText, count:count, modeText:modeText
};
const SIG={GREEN:'GREEN',YELLOW:'YELLOW',RED:'RED'};
const PH=['M1_G','M1_Y','AR','M2_G','M2_Y','AR'];
let phaseIdx=0, remaining=0;

/* ========= æ¨¡å¼ ========= */
const RECORD={enabled:true};
function setMode(rec){
  RECORD.enabled=rec;
  btnRecord.classList.toggle('active',rec);
  btnLive.classList.toggle('active',!rec);
  UI.modeText.textContent=rec?'RECORD':'LIVE';
  boot();
}

/* ========= å•Ÿå‹• ========= */
function boot(){
  phaseIdx=0;
  remaining=getDur();
}
function getDur(){
  const d=[
    Number(tM1SG.value), Number(tM1Y.value), Number(tAR.value),
    Number(tM2G.value), Number(tM2Y.value), Number(tAR.value)
  ];
  return d[phaseIdx];
}

/* ========= Loop ========= */
let last=performance.now();
function loop(t){
  const dt=(t-last)/1000; last=t;
  remaining-=dt;
  if(remaining<=0){
    phaseIdx=(phaseIdx+1)%PH.length;
    remaining=getDur();
  }
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* ========= Draw ========= */
function draw(){
  ctx.clearRect(0,0,cv.width,cv.height);
  ctx.strokeStyle='#334155'; ctx.lineWidth=6;
  ctx.strokeRect(80,80,cv.width-160,cv.height-160);

  const p=PH[phaseIdx];
  let col='#ef4444',dot='red';
  if(p.includes('G')){col='#22c55e';dot='green'}
  else if(p.includes('Y')){col='#eab308';dot='yellow'}

  ctx.fillStyle=col;
  ctx.beginPath(); ctx.arc(cv.width/2,cv.height/2,20,0,Math.PI*2); ctx.fill();

  UI.phaseText.textContent='Phaseï¼š'+p;
  UI.phaseDot.className='dot '+dot;
  UI.count.textContent=Math.ceil(remaining);
}

/* ========= Buttons ========= */
btnRecord.onclick=()=>setMode(true);
btnLive.onclick=()=>setMode(false);

/* ========= Init ========= */
boot();
</script>
</body>
</html>
